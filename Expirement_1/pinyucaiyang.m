% 频域采样实验：给定离散信号 x(n)，验证频域采样定理

% ----------------- 1. 构造题目给出的序列 x(n) -----------------
% n 从 0 到 26，一共 27 个点
n=0:26;

% 先全部置为 0，后面根据条件分别赋值
x=zeros(size(n));

% 0 <= n <= 13 时，x(n) = n + 1
idx1=(n>=0)&(n<=13);
x(idx1)=n(idx1)+1;

% 14 <= n <= 26 时，x(n) = 27 - n
idx2=(n>=14)&(n<=26);
x(idx2)=27-n(idx2);

% ----------------- 2. 补零到 32 点，做 32 点 DFT -----------------
x32=[x zeros(1,32-length(x))];

% 计算 32 点 FFT，得到 X_32(k)，k = 0,1,...,31
X32=fft(x32,32);
k32=0:31;                 % 频率序号 k
w32=2*pi*k32/32;          % 对应的数字角频率 omega = 2*pi*k/32

% ----------------- 3. 在频域做“抽样”得到 16 点频谱 -----------------
% 取 X_32(k) 的偶数点：k = 0,2,4,...,30
% 这 16 个点可以看作是在 [0, 2π] 上的 16 点频域采样 X_16(k)
X16=X32(1:2:32);          % 注意 MATLAB 下标从 1 开始：1,3,5,...,31
k16=0:15;                 % 对应的 k = 0,...,15
w16=2*pi*k16/16;          % 对应的数字角频率 omega = 2*pi*k/16

% ----------------- 4. 频谱和时域波形：所有图放在一个 figure 中 -----------------
% 先在频域做 IFFT，得到对应的时域序列
% 对 32 点频谱做 IFFT，得到长度为 32 的时域序列 x_32(n)
x32_t=ifft(X32,32);

% 对 16 点频谱做 IFFT，得到长度为 16 的时域序列 x_16(n)
x16_t=ifft(X16,16);

% 使用一个 figure，6 个子图，布局为 3 行 2 列：
% 第 1 行：32 点/16 点频谱
% 第 2 行：原始序列 x(n) 与 32 点还原序列 x_32(n)
% 第 3 行：16 点还原序列 x_16(n)（右侧留作说明）
figure;

% 第 1 行左图：32 点频谱的幅度
subplot(3,2,1);
plot(w32,abs(X32));
xlabel('\omega');
ylabel('|X_{32}(k)|');
title('32点频谱 |X_{32}(k)|');

% 第 1 行右图：16 点频谱的幅度
subplot(3,2,2);
plot(w16,abs(X16));
xlabel('\omega');
ylabel('|X_{16}(k)|');
title('16点频谱 |X_{16}(k)|');

% 第 2 行左图：原始序列 x(n)，长度 27
subplot(3,2,3);
stem(n,x,'filled');
xlabel('n');
ylabel('x(n)');
title('原序列 x(n)');

% 第 2 行右图：由 32 点频谱还原的序列 x_32(n)
subplot(3,2,4);
stem(0:31,real(x32_t),'filled');
xlabel('n');
ylabel('x_{32}(n)');
title('由32点频谱还原的 x_{32}(n)');

% 第 3 行左图：由 16 点频谱还原的序列 x_16(n)
subplot(3,2,5);
stem(0:15,real(x16_t),'filled');
xlabel('n');
ylabel('x_{16}(n)');
title('由16点频谱还原的 x_{16}(n)');

% 第 3 行右图：文字说明（可帮助理解频域采样关系）
subplot(3,2,6);
axis off;
text(0.05,0.7,'频域采样关系：','FontSize',11);
text(0.05,0.5,'X_{16}(k) = X_{32}(2k),  k = 0,1,...,15','FontSize',11);
text(0.05,0.3,'对比 x(n), x_{32}(n), x_{16}(n) 观察失真','FontSize',11);
