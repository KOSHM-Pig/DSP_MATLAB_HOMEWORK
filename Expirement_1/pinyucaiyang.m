% 频域采样实验：给定离散信号 x(n)，验证频域采样定理

% ----------------- 1. 构造题目给出的序列 x(n) -----------------
% n 从 0 到 26，一共 27 个点
n=0:26;

% 先全部置为 0，后面根据条件分别赋值
x=zeros(size(n));

% 0 <= n <= 13 时，x(n) = n + 1
idx1=(n>=0)&(n<=13);
x(idx1)=n(idx1)+1;

% 14 <= n <= 26 时，x(n) = 27 - n
idx2=(n>=14)&(n<=26);
x(idx2)=27-n(idx2);

% ----------------- 2. 补零到 32 点，做 32 点 DFT -----------------
x32=[x zeros(1,32-length(x))];

% 计算 32 点 FFT，得到 X_32(k)，k = 0,1,...,31
X32=fft(x32,32);
k32=0:31;                 % 频率序号 k
w32=2*pi*k32/32;          % 对应的数字角频率 omega = 2*pi*k/32

% ----------------- 3. 在频域做“抽样”得到 16 点频谱 -----------------
% 取 X_32(k) 的偶数点：k = 0,2,4,...,30
% 这 16 个点可以看作是在 [0, 2π] 上的 16 点频域采样 X_16(k)
X16=X32(1:2:32);          % 注意 MATLAB 下标从 1 开始：1,3,5,...,31
k16=0:15;                 % 对应的 k = 0,...,15
w16=2*pi*k16/16;          % 对应的数字角频率 omega = 2*pi*k/16

% ----------------- 4. 按实验要求画出频谱与时域波形（一个figure，三行两列） -----------------
% 为了近似连续的 X(e^{j\omega})，对 x32 做更高分辨率的 DFT
Nw=512;
Xw=fft(x32,Nw);
w=(0:Nw-1)*2*pi/Nw;     % 在 [0, 2π] 上的细网格频率点

% 对 32 点频谱做 IFFT，得到长度为 32 的时域序列 x_32(n)
x32_t=ifft(X32,32);

% 对 16 点频谱做 IFFT，得到长度为 16 的时域序列 x_16(n)
x16_t=ifft(X16,16);

% 建一个 figure，六个子图，布局为 3 行 2 列
figure;

% 图1：连续频谱 |X(e^{j\omega})|
subplot(3,2,1);
plot(w,abs(Xw));
xlabel('\omega');
ylabel('|X(e^{j\omega})|');
title('近似连续频谱 |X(e^{j\omega})|');

% 图2：32 点频域采样 |X_{32}(k)|
subplot(3,2,2);
stem(w32,abs(X32),'filled');
xlabel('\omega');
ylabel('|X_{32}(k)|');
title('32点频谱 |X_{32}(k)|');

% 图3：16 点频域采样 |X_{16}(k)|
subplot(3,2,3);
stem(w16,abs(X16),'filled');
xlabel('\omega');
ylabel('|X_{16}(k)|');
title('16点频谱 |X_{16}(k)|');

% 图4：原始序列 x(n)
subplot(3,2,4);
stem(n,x,'filled');
xlabel('n');
ylabel('x(n)');
title('原序列 x(n)');

% 图5：由 32 点频谱还原的序列 x_{32}(n)
subplot(3,2,5);
stem(0:31,real(x32_t),'filled');
xlabel('n');
ylabel('x_{32}(n)');
title('由32点频谱还原的 x_{32}(n)');

% 图6：由 16 点频谱还原的序列 x_{16}(n)
subplot(3,2,6);
stem(0:15,real(x16_t),'filled');
xlabel('n');
ylabel('x_{16}(n)');
title('由16点频谱还原的 x_{16}(n)');
